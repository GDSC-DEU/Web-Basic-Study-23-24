<!DOCTYPE html>
<html>
  <head>
    <title>JavaScript Sandbox</title>
    <meta charset="UTF-8" />
  </head>
  <body>
    <div id="app">
      <h1>HTTP API ì‹¤ìŠµ</h1>
      <h4>(ê·¸ëŸ°ë° ì´ì œ ê³ ì–‘ì´ğŸ˜¸ APIë¥¼ ê³ë“¤ì¸)</h2>
      <div>
        <input type="number"/>
        <button id="load_cat_image_btn">ê³ ì–‘ì´ ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸°</button>
      </div>
      <div id="image_wrapper">
      </div>
    <script>
        // ê³ ì–‘ì´ ì‚¬ì§„ì„ ê°€ì ¸ì™€ì„œ img íƒœê·¸ì— ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
        async function loadCatImage() {
            var photoUrls = [];  
            var blobDatas = [];

            // ì´ì „ì— ê°€ì ¸ì™”ë˜ ê³ ì–‘ì´ ì‚¬ì§„ ì‚­ì œ
            var catImageTags = document.getElementsByClassName("cat_image");
            while (catImageTags.length > 0)
            {
                catImageTags[0].remove();
            }
            // fetch í•¨ìˆ˜ë¡œ HTTPë¥¼ ì´ìš©í•´ ê³ ì–‘ì´ ì‚¬ì§„ ë¶ˆëŸ¬ì˜¤ê¸°
            var i = 0;
            // ì…ë ¥ëœ ìˆ˜ ë§Œí¼ APIë¥¼ í˜¸ì¶œí•´ì„œ ì‚¬ì§„ì„ ê°€ì ¸ì˜¤ê¸°
            var number = document.querySelector('input[type="number"]').value;
            while (i < number)
            {
                var response = await fetch("https://cataas.com/cat", {
                    method: "GET",
                });
                // ê°€ì ¸ì˜¨ ì‚¬ì§„ ë°ì´í„°ë¥¼ html íƒœê·¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë§Œë“¤ê¸°
                var blobData = await response.blob();
                blobDatas.push(blobData);
                var imageUrl = window.URL.createObjectURL(blobDatas[i]);
                photoUrls.push(imageUrl);
                i++;
            }
            i = 0
            while (i < number)
            {
                // ë¶ˆëŸ¬ì˜¨ ê³ ì–‘ì´ ì‚¬ì§„ì„ ê° img íƒœê·¸ì— ë³´ì—¬ì£¼ê¸° 
                document.getElementById("image_wrapper").innerHTML += ('<img class="cat_image" src=' + photoUrls[i] + ">");
                i++;
            }
        }
        // ë²„íŠ¼ì„ í´ë¦­ì‹œ LoadCatImage í•¨ìˆ˜ê°€ í˜¸ì¶œ ë˜ê²Œ í•˜ê¸°
        const loadCatButton = document.getElementById("load_cat_image_btn");
        loadCatButton.addEventListener("click", loadCatImage);
    </script>
    </div>
  </body>
</html>